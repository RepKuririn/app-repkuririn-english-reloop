# プレイバック速度調整機能 - テストガイド

Phase 8 - 機能2で実装されたプレイバック速度調整機能のテスト手順です。

## 機能概要

動画の再生速度を0.5x〜2.0xの間で調整できる機能。語学学習において、難しい箇所をゆっくり聞いたり、理解した箇所を速く流すのに便利です。

## テスト項目

### A. 基本操作テスト

#### A-1: スピードコントロールUI表示
- [ ] パネルヘッダーに速度調整ボタンが6つ表示される
- [ ] ボタンラベル: 0.5x, 0.75x, 1.0x, 1.25x, 1.5x, 2.0x
- [ ] 初期状態で1.0xボタンがアクティブ（青色ハイライト）

#### A-2: 速度変更
- [ ] 0.5xボタンをクリック → 再生速度が0.5倍に変更される
- [ ] 0.75xボタンをクリック → 再生速度が0.75倍に変更される
- [ ] 1.25xボタンをクリック → 再生速度が1.25倍に変更される
- [ ] 1.5xボタンをクリック → 再生速度が1.5倍に変更される
- [ ] 2.0xボタンをクリック → 再生速度が2.0倍に変更される
- [ ] 1.0xボタンをクリック → 通常速度に戻る

#### A-3: UIフィードバック
- [ ] 速度変更時にトースト通知が表示される（例: "🎵 再生速度: 1.5x"）
- [ ] クリックしたボタンが青色にハイライトされる
- [ ] 前回選択されていたボタンのハイライトが解除される
- [ ] アクティブボタンが1つだけ（複数選択されない）

### B. ビデオプレイヤー連携テスト

#### B-1: 実際の再生速度反映
- [ ] 0.5x選択時、音声・字幕が明らかにゆっくり再生される
- [ ] 2.0x選択時、音声・字幕が明らかに速く再生される
- [ ] 動画再生中に速度変更しても途切れない
- [ ] 動画一時停止中でも速度変更できる

#### B-2: YouTube標準プレイヤーとの整合性
- [ ] YouTube標準の速度設定（歯車アイコン）と連動する
- [ ] 拡張機能で速度変更後、YouTube標準プレイヤーに反映される
- [ ] 両方の速度表示が一致している

### C. ループ機能との併用テスト

#### C-1: ループ中の速度変更
- [ ] ループ設定後に速度変更 → 新しい速度でループ継続
- [ ] 速度変更してもループ範囲が維持される
- [ ] 速度変更してもループ開始位置にシークされない（継続再生）

#### C-2: 速度設定後のループ設定
- [ ] 0.5xに設定してからループ開始点設定 → 遅い速度でループ実行
- [ ] 2.0xに設定してからループ開始点設定 → 速い速度でループ実行
- [ ] ループクリア後も速度設定は維持される

### D. エッジケースとエラーハンドリング

#### D-1: ビデオ未読み込み時
- [ ] ページ読み込み直後に速度ボタンをクリック → エラー通知表示
- [ ] ビデオ読み込み後は正常に動作する

#### D-2: 複数タブでの動作
- [ ] タブAで速度変更 → タブAのみ反映される
- [ ] タブBに切り替え → タブBは独立した速度設定を持つ
- [ ] 各タブが個別に速度を管理できる

#### D-3: ビデオ切り替え時
- [ ] 別の動画に遷移 → 速度設定がリセットされる（1.0x）
- [ ] 同じ動画でシークしても速度設定は維持される

### E. UI/UXテスト

#### E-1: ボタンホバー
- [ ] 速度ボタンにマウスホバー → 薄青色の背景表示
- [ ] ホバー時にtitle属性でツールチップ表示（"再生速度: 1.5x"）

#### E-2: アクティブボタンの視認性
- [ ] アクティブボタンが他のボタンと明確に区別できる
- [ ] 白文字・青背景で視認性が高い
- [ ] ダークモード環境でも視認できる（YouTubeダークテーマ）

#### E-3: レイアウト
- [ ] 6つのボタンが横一列に配置される
- [ ] ボタン間に適切な間隔がある（4px gap）
- [ ] パネルヘッダー内で適切に配置される（タイトルと更新ボタンの間）

### F. パフォーマンステスト

#### F-1: レスポンス速度
- [ ] ボタンクリックから速度変更まで遅延がない（即座に反映）
- [ ] 連続クリックしても正常に動作する
- [ ] 高速切り替え（0.5x→2.0x→0.5x）でも問題ない

#### F-2: リソース消費
- [ ] 速度変更時にメモリリークが発生しない
- [ ] DevTools Consoleにエラーが出ない
- [ ] 動画再生がカクつかない

## 合格基準

- **必須項目**: A-1〜A-3, B-1, C-1 が全て合格
- **推奨項目**: B-2, C-2, D-1〜D-3, E-1〜E-3 が80%以上合格
- **パフォーマンス**: F-1〜F-2 が全て合格

## トラブルシューティング

### 問題: 速度が変更されない
**原因**: ビデオ要素が見つからない
**解決策**: ページをリロードして再試行

### 問題: アクティブボタンが複数表示される
**原因**: UIの状態管理エラー
**解決策**: DevTools Consoleでエラーログを確認し、拡張機能を再読み込み

### 問題: YouTube標準プレイヤーと速度が異なる
**原因**: 同期タイミングのずれ
**解決策**: 速度ボタンを再クリックして同期

---

**実装完了日**: 2026-01-15
**関連機能**: Phase 8 - 機能2
**関連ファイル**:
- src/content/player.ts (setPlaybackRate関数)
- src/content/ui/panel.ts (handleSpeedChange関数)
- src/content/ui/styles.css (.sl-speed-control)
- src/content/constants.ts (PLAYBACK_SPEEDS)
